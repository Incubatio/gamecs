// Generated by CoffeeScript 1.4.0
(function() {
  var start;

  start = new Date().getTime();

  require(['gamejs'], function(gamejs) {
    var main;
    main = function() {
      var display, font, handleEvent, tick, worker, yOffset;
      display = gamejs.Display.setMode([800, 600]);
      gamejs.Display.setCaption("Example Simple Worker");
      worker = new Worker('/gamecs/build/examples/workers/primes-require.js');
      font = new gamejs.Font();
      yOffset = 50;
      worker.onmessage = function(event) {
        var startNumber;
        worker.onmessage = function(event) {
          return gamejs.Key.post({
            type: gamejs.Key.WORKER_RESULT,
            data: {
              prime: event.data
            }
          });
        };
        startNumber = parseInt(1230023 + (Math.random() * 10000));
        display.blit(font.render('Asking worker for primes after ' + startNumber), [10, 30]);
        return worker.postMessage({
          todo: "nextprimes",
          start: startNumber
        });
      };
      handleEvent = function(event) {
        var end;
        if (event.type === gamejs.Key.WORKER_RESULT) {
          display.blit(font.render('Worker answered: ' + event.data.prime), [10, yOffset]);
          yOffset += 20;
          end = new Date().getTime();
          return console.log((end - start) + 'ms');
        }
      };
      tick = function(msDuration) {
        return gamejs.Key.get().forEach(handleEvent);
      };
      return gamejs.Time.interval(tick);
    };
    return gamejs.ready(main);
  });

}).call(this);
